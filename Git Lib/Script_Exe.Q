[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=7c1356dd-a163-4bbc-8862-dfe695e36ace
Description=Script_Exe
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Root_URL = "D:\HeuteNacht\anjian\"

//Msgbox "start"
Call myFile_Read(Root_URL &"Open_Shadowverse.txt")
Msgbox "Complete!"


//获取目录下：文件名 complete
Function myFile_Read(URL)
	Dim myarray, i, Text
	//Msgbox "start"
	FileExist=Plugin.File.IsFileExist(URL)
	If FileExist Then
		f = Plugin.File.OpenFile(URL)
		//Msgbox "opened"
		Text = "T"
		i = 0
		While Text<>""
			Text = Plugin.File.ReadLine(f)
			//Msgbox "text"&i&"="&Text
			//Text2=Plugin.File.ReadFile(f)
			Call Code_Exe(Text)
    		//Msgbox "text"&i&"="&Text// & "text2="& Text2
    		i = i + 1
		Wend
		Plugin.File.CloseFile f
	End If
//Msgbox "Complete!"
End Function



Function Code_Exe(codes)
	Dim Code_Array, Code_Len
	Dim code, x, y, time_delay
	
	code="None"		//code default is "None"
	Code_Array = split(codes,",")
	//Msgbox "Codes="&codes
	Code_Len = UBound(Code_Array)
	
	If (Code_Len = 3) Then //if codes have exactly three parall;Tips:"="表示等于和赋值
		code = Code_Array(2)//code setting in 3th position e.g x,y,code
		//Msgbox "Code="&Code_Array(2)
		x = Code_Array(0)
		y = Code_Array(1)
		time_delay = Code_Array(3)
	End If
	
	Select Case code
		Case "D", "d"
			Call myDouble_Click(x, y, time_delay)
		Case "C", "c"
			Call myLeft_Click(x, y, time_delay)
		Case "R", "r"
			Call myRight_Click(x, y, time_delay)
		Case Else
			//Msgbox "Undefined Codes"
	End Select
	
End Function

Function myDouble_Click(x, y,Time)
	MoveTo x,y
	LeftDoubleClick 1
	Delay Time
End Function

Function myRight_Click(x, y,Time)
	MoveTo x,y
	RightClick 1
	Delay Time
End Function

Function myLeft_Click(x, y,Time)
	MoveTo x,y
	LeftClick 1
	Delay Time
End Function


